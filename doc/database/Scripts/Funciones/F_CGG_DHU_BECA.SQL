/**
* FUNCION SII.F_CGG_DHU_BECA_INSERT
* INGRESA UN REGISTRO EN LA TABLA SII.CGG_DHU_BECA.
* @param IN_CDBEC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE BECA
* @param IN_CDTBC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TIPO DE BECA
* @param IN_CGESP_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE ESPECIALIDAD
* @param IN_CGIED_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE INSTITUCION EDUCATIVA
* @param IN_CPAIS_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE PAIS
* @param IN_CGTPR_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TITULO PROFESONAL
* @param IN_CRPER_CODIGO CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA
* @param IN_CGG_CRPER_CODIGO CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA FUNCIONARIO CGG
* @param IN_CRPJR_CODIGO IDENTIFICATIVO UNICO DE REGSITRO  ENTIDAD FINANCIERA
* @param IN_CDBEC_NUMERO NUMERO DE LA BECA FORMADO POR LA ABREVIATURA DEL TIPO DE BECA MAS SECUENCIAL
* @param IN_CDBEC_FECHA_INGRESO FECHA DE INGRESO A LA BECA O CARRERA
* @param IN_CDBEC_FUNCIONARIO NOMBRE DEL FUNCIONARIO QUE APROBO LA BECA O CARRERA
* @param IN_CDBEC_NUMERO_APROBACION NUMERO DEL DOCUMENTO DE APROBACION DE LA BECA
* @param IN_CDBEC_FECHA_INICIO FECHA DE INICIO DE LA BECA 
* @param IN_CDBEC_FECHA_FIN FECHA DE FINALIZACION DE LA BECA 
* @param IN_CDBEC_NUMERO_CONVENIO NUMERO IDENTIFICADOR DEL CONTRATO O CONVENIO
* @param IN_CDBEC_VSALIDA_ORIGEN ORIGEN DEL VUELO DE SALIDA
* @param IN_CDBEC_VSALIDA_DESTINO DESTINO DEL VUELO DE SALIDA
* @param IN_CDBEC_VSALIDA_VALOR VALOR DEL PASAJE DE SALIDA
* @param IN_CDBEC_VRETORNO_ORIGEN ORIGEN DEL VUELO DE RETORNO
* @param IN_CDBEC_VRETORNO_DESTINO DESTINO DEL VUELO DE RETORNO
* @param IN_CDBEC_VRETORNO_VALOR VALOR DEL PASAJE DE RETORNO
* @param IN_CDBEC_CARRERA NOMBRE DE LA CARRERA A SEGUIR 
* @param IN_CDBEC_TIPO_CICLO TIPOS DE CICLIO DE LAS CARRERAS PROFESIONALES
0 - ANUAL
1 - SEMESTRAL
2 - QUIMESTRAL
3 - OTROS
* @param IN_CDBEC_TOTAL_CICLOS TOTAL DE CICLIO QUE DEBE CUMPLIR PARA APROBAR LA CARRERA.
* @param IN_CDBEC_NUMERO_CUENTO NUEMRO DE CUENTA PARA EL DEPOSITO DEL DINERO DE LA BECA
* @param IN_CDBEC_NUMERO_APROBACION_MODIFICATORIO NUMERO DEL DOCUMENTO DE APROBACION DE LA BECA QUE SERA MODIFICADA
* @param IN_CDBEC_NUMERO_CONTRATO_MODIFICATORIO NUMERO DEL DOCUMENTO DE CONTRATO DE LA BECA QUE SERA MODIFICADA
* @param IN_CDBEC_OBSERVACION_CONTARTO_MODIFICATORIO NUMERO DEL DOCUMENTO DE CONTRATO DE LA BECA QUE SERA MODIFICADA
* @param IN_CDBEC_OBSERVACION INFORMACION ADICIONAL
* @param IN_CDBEC_TITULO_ENTREGADO ESTADO QUE DETERMINA SI LA PERSONA ENTREGO UNA COPIA DE SU TITULO PROFESIONAL
* @param IN_CDBEC_BECA_DEVENGADA DETERMINA SI UNA BECA YA FUE RECOMPENSADA CON TRABAJO EN LA PROVINCIA
* @param IN_CDBEC_ESTADO_APROBACION CAMPO NUMERICO QUE INDICA LOS ESTADOS DE CONCLUSION DE LAS BECAS:
 0 - NO CONCLUIDA 
 1 - CONCLUIDA
 2 - REPROBADA
 3 - TERMINADA POR CASO FORTUITO

* @param IN_CDBEC_VALOR_REEMBOLSO CAMPO QUE SE REGISTRA EL VALOR DE REMBOLSO POR NO CULMINAR LA BECA
* @param IN_CDBEC_ESTADO ESTADO DEL REGISTRO
* @param IN_CDBEC_USUARIO_INSERT USUARIO QUE INGRESO LA INFORMACION EN EL SISTEMA
* @param IN_CDBEC_USUARIO_UPDATE USUARIO QUE REALIZO LA ACTUALIZACION DE LA INFORMACION
* @return VARCHAR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_INSERT(
IN IN_CDBEC_CODIGO SII.CGG_DHU_BECA.CDBEC_CODIGO%TYPE, 
IN IN_CDTBC_CODIGO SII.CGG_DHU_BECA.CDTBC_CODIGO%TYPE, 
IN IN_CGESP_CODIGO SII.CGG_DHU_BECA.CGESP_CODIGO%TYPE, 
IN IN_CGIED_CODIGO SII.CGG_DHU_BECA.CGIED_CODIGO%TYPE, 
IN IN_CPAIS_CODIGO SII.CGG_DHU_BECA.CPAIS_CODIGO%TYPE, 
IN IN_CGTPR_CODIGO SII.CGG_DHU_BECA.CGTPR_CODIGO%TYPE, 
IN IN_CRPER_CODIGO SII.CGG_DHU_BECA.CRPER_CODIGO%TYPE, 
IN IN_CGG_CRPER_CODIGO SII.CGG_DHU_BECA.CGG_CRPER_CODIGO%TYPE, 
IN IN_CRPJR_CODIGO SII.CGG_DHU_BECA.CRPJR_CODIGO%TYPE, 
IN IN_CDBEC_NUMERO SII.CGG_DHU_BECA.CDBEC_NUMERO%TYPE, 
IN IN_CDBEC_FECHA_INGRESO SII.CGG_DHU_BECA.CDBEC_FECHA_INGRESO%TYPE, 
IN IN_CDBEC_FUNCIONARIO SII.CGG_DHU_BECA.CDBEC_FUNCIONARIO%TYPE, 
IN IN_CDBEC_NUMERO_APROBACION SII.CGG_DHU_BECA.CDBEC_NUMERO_APROBACION%TYPE, 
IN IN_CDBEC_FECHA_INICIO SII.CGG_DHU_BECA.CDBEC_FECHA_INICIO%TYPE, 
IN IN_CDBEC_FECHA_FIN SII.CGG_DHU_BECA.CDBEC_FECHA_FIN%TYPE, 
IN IN_CDBEC_NUMERO_CONVENIO SII.CGG_DHU_BECA.CDBEC_NUMERO_CONVENIO%TYPE, 
IN IN_CDBEC_VSALIDA_ORIGEN SII.CGG_DHU_BECA.CDBEC_VSALIDA_ORIGEN%TYPE, 
IN IN_CDBEC_VSALIDA_DESTINO SII.CGG_DHU_BECA.CDBEC_VSALIDA_DESTINO%TYPE, 
IN IN_CDBEC_VSALIDA_VALOR SII.CGG_DHU_BECA.CDBEC_VSALIDA_VALOR%TYPE, 
IN IN_CDBEC_VRETORNO_ORIGEN SII.CGG_DHU_BECA.CDBEC_VRETORNO_ORIGEN%TYPE, 
IN IN_CDBEC_VRETORNO_DESTINO SII.CGG_DHU_BECA.CDBEC_VRETORNO_DESTINO%TYPE, 
IN IN_CDBEC_VRETORNO_VALOR SII.CGG_DHU_BECA.CDBEC_VRETORNO_VALOR%TYPE, 
IN IN_CDBEC_CARRERA SII.CGG_DHU_BECA.CDBEC_CARRERA%TYPE, 
IN IN_CDBEC_TIPO_CICLO SII.CGG_DHU_BECA.CDBEC_TIPO_CICLO%TYPE, 
IN IN_CDBEC_TOTAL_CICLOS SII.CGG_DHU_BECA.CDBEC_TOTAL_CICLOS%TYPE, 
IN IN_CDBEC_NUMERO_CUENTO SII.CGG_DHU_BECA.CDBEC_NUMERO_CUENTO%TYPE, 
IN IN_CDBEC_NUMERO_APROBACION_MODIFICATORIO SII.CGG_DHU_BECA.CDBEC_NUMERO_APROBACION_MODIFICATORIO%TYPE,
IN IN_CDBEC_NUMERO_CONTRATO_MODIFICATORIO SII.CGG_DHU_BECA.CDBEC_NUMERO_CONTRATO_MODIFICATORIO%TYPE,
IN IN_CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO SII.CGG_DHU_BECA.CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO%TYPE,
IN IN_CDBEC_OBSERVACION SII.CGG_DHU_BECA.CDBEC_OBSERVACION%TYPE, 
IN IN_CDBEC_TITULO_ENTREGADO SII.CGG_DHU_BECA.CDBEC_TITULO_ENTREGADO%TYPE, 
IN IN_CDBEC_BECA_DEVENGADA SII.CGG_DHU_BECA.CDBEC_BECA_DEVENGADA%TYPE, 
IN IN_CDBEC_ESTADO_APROBACION SII.CGG_DHU_BECA.CDBEC_ESTADO_APROBACION%TYPE, 
IN IN_CDBEC_VALOR_REEMBOLSO SII.CGG_DHU_BECA.CDBEC_VALOR_REEMBOLSO%TYPE, 
IN IN_CDBEC_ESTADO SII.CGG_DHU_BECA.CDBEC_ESTADO%TYPE, 
IN IN_CDBEC_USUARIO_INSERT SII.CGG_DHU_BECA.CDBEC_USUARIO_INSERT%TYPE, 
IN IN_CDBEC_USUARIO_UPDATE SII.CGG_DHU_BECA.CDBEC_USUARIO_UPDATE%TYPE
)RETURNS VARCHAR AS
$$
DECLARE
OUT_KEY VARCHAR;
TMP_NUM_BECA VARCHAR;
TMP_COUNT INT;
BEGIN
	SELECT COUNT(CRPER_CODIGO) INTO TMP_COUNT FROM CGG_DHU_BECA WHERE CDBEC_ESTADO=TRUE AND CRPER_CODIGO= IN_CRPER_CODIGO AND (CDBEC_ESTADO_APROBACION=0 OR CDBEC_ESTADO_APROBACION=1 OR CDBEC_ESTADO_APROBACION=2 OR CDBEC_ESTADO_APROBACION=4 OR CDBEC_ESTADO_APROBACION=5) ;
	IF (TMP_COUNT > 0) THEN
		RAISE EXCEPTION 'El beneficiario ya tienen una beca registrada o tiene una en seguimiento.';
	END IF;
	IF (UPPER(IN_CDBEC_CODIGO) = 'KEYGEN') THEN
		SELECT SII.F_KEYGEN('CGG_DHU_BECA','CDBEC_CODIGO','CDBEC') INTO OUT_KEY;
	ELSE
		OUT_KEY := IN_CDBEC_CODIGO;
	END IF;
	
	SELECT F_CGG_GENERA_NUM_BECA() INTO TMP_NUM_BECA;
	
	INSERT INTO SII.CGG_DHU_BECA(
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO, 
		CDBEC_NUMERO_APROBACION_MODIFICATORIO,
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	) VALUES (
		OUT_KEY, 
		IN_CDTBC_CODIGO, 
		IN_CGESP_CODIGO, 
		IN_CGIED_CODIGO, 
		IN_CPAIS_CODIGO, 
		IN_CGTPR_CODIGO, 
		IN_CRPER_CODIGO, 
		IN_CGG_CRPER_CODIGO, 
		IN_CRPJR_CODIGO, 
		TMP_NUM_BECA,--IN_CDBEC_NUMERO, 
		IN_CDBEC_FECHA_INGRESO, 
		IN_CDBEC_FUNCIONARIO, 
		IN_CDBEC_NUMERO_APROBACION, 
		IN_CDBEC_FECHA_INICIO, 
		IN_CDBEC_FECHA_FIN, 
		IN_CDBEC_NUMERO_CONVENIO, 
		IN_CDBEC_VSALIDA_ORIGEN, 
		IN_CDBEC_VSALIDA_DESTINO, 
		IN_CDBEC_VSALIDA_VALOR, 
		IN_CDBEC_VRETORNO_ORIGEN, 
		IN_CDBEC_VRETORNO_DESTINO, 
		IN_CDBEC_VRETORNO_VALOR, 
		IN_CDBEC_CARRERA, 
		IN_CDBEC_TIPO_CICLO, 
		IN_CDBEC_TOTAL_CICLOS, 
		IN_CDBEC_NUMERO_CUENTO, 
		IN_CDBEC_NUMERO_APROBACION_MODIFICATORIO,
		IN_CDBEC_NUMERO_CONTRATO_MODIFICATORIO,
		IN_CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		IN_CDBEC_OBSERVACION, 
		IN_CDBEC_TITULO_ENTREGADO, 
		IN_CDBEC_BECA_DEVENGADA, 
		IN_CDBEC_ESTADO_APROBACION, 
		IN_CDBEC_VALOR_REEMBOLSO, 
		IN_CDBEC_ESTADO, 
		CURRENT_TIMESTAMP, 
		IN_CDBEC_USUARIO_INSERT, 
		CURRENT_TIMESTAMP, 
		IN_CDBEC_USUARIO_UPDATE
	);
	RETURN OUT_KEY;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_SELECT_AS
* SELECCIONA TODOS LOS REGISTROS DE LA TABLA SII.CGG_DHU_BECA.
* @param IN_USER_NAME NOMBRE DE USUARIO DEL SERVIDOR DE APP. O DE LA BASE DE DATOS
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_SELECT_AS(
IN IN_USER_NAME VARCHAR
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO, 
		CDBEC_NUMERO_APROBACION_MODIFICATORIO,
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_SELECT
* SELECCIONA N REGISTROS DE LA TABLA SII.CGG_DHU_BECA.
* @param IN_USER_NAME NOMBRE DE USUARIO DEL SERVIDOR DE APP. O DE LA BASE DE DATOS
* @param IN_START_INDEX INDICE DE INICIO DE REGISTROS
* @param IN_LIMIT NUMERO DE REGISTRO DISCRIMINADOS
* @param IN_SORT_FIELD_NAME COLUMNA DE ORDENAMIENTO.
* @param IN_DIRECTION DIRECCION DEL ORDENAMIENTO ASC/DESC
* @param IN_FIND_TEXT CRITERIO DE BUSQUEDA
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_SELECT(
IN IN_USER_NAME VARCHAR,
IN IN_START_INDEX INT,
IN IN_LIMIT INT,
IN IN_SORT_FIELD_NAME VARCHAR,
IN IN_DIRECTION VARCHAR,
IN IN_FIND_TEXT TEXT
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR EXECUTE
	'SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO, 
		CDBEC_NUMERO_APROBACION_MODIFICATORIO,
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND SII.F_STRING_IN('''||IN_FIND_TEXT||''',COALESCE(CDBEC_NUMERO, '''')||'' ''||COALESCE(CDBEC_FECHA_INGRESO, CURRENT_TIMESTAMP)||'' ''||COALESCE(CDBEC_FUNCIONARIO, '''')||'' ''||COALESCE(CDBEC_NUMERO_APROBACION, '''')||'' ''||COALESCE(CDBEC_FECHA_INICIO, CURRENT_TIMESTAMP)||'' ''||COALESCE(CDBEC_FECHA_FIN, CURRENT_TIMESTAMP)||'' ''||COALESCE(CDBEC_NUMERO_CONVENIO, '''')||'' ''||COALESCE(CDBEC_VSALIDA_ORIGEN, '''')||'' ''||COALESCE(CDBEC_VSALIDA_DESTINO, '''')||'' ''||COALESCE(CDBEC_VSALIDA_VALOR, 0)||'' ''||COALESCE(CDBEC_VRETORNO_ORIGEN, '''')||'' ''||COALESCE(CDBEC_VRETORNO_DESTINO, '''')||'' ''||COALESCE(CDBEC_VRETORNO_VALOR, 0)||'' ''||COALESCE(CDBEC_CARRERA, '''')||'' ''||COALESCE(CDBEC_TIPO_CICLO, 0)||'' ''||COALESCE(CDBEC_TOTAL_CICLOS, 0)||'' ''||COALESCE(CDBEC_NUMERO_CUENTO, '''')||'' ''||COALESCE(CDBEC_NUMERO_APROBACION_MODIFICATORIO,'''')||'' ''||COALESCE(CDBEC_NUMERO_CONTRATO_MODIFICATORIO,'''')||'' ''||COALESCE(CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,'''')||'' ''||COALESCE(CDBEC_OBSERVACION, '''')||'' ''||COALESCE(CDBEC_TITULO_ENTREGADO, FALSE)||'' ''||COALESCE(CDBEC_BECA_DEVENGADA, FALSE)||'' ''||COALESCE(CDBEC_ESTADO_APROBACION, 0)||'' ''||COALESCE(CDBEC_VALOR_REEMBOLSO, 0)||'' ''||COALESCE(CDBEC_ESTADO, FALSE)||'' ''||COALESCE(CDBEC_FECHA_INSERT, CURRENT_TIMESTAMP)||'' ''||COALESCE(CDBEC_USUARIO_INSERT, '''')||'' ''||COALESCE(CDBEC_FECHA_UPDATE, CURRENT_TIMESTAMP)||'' ''||COALESCE(CDBEC_USUARIO_UPDATE, '''')) = 1
	ORDER BY '||IN_SORT_FIELD_NAME||' '||IN_DIRECTION||
	' LIMIT '||IN_LIMIT||' OFFSET '||IN_START_INDEX;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_COUNT
* CONTABILIZA EL NUMERO DE REGISTROS DE LA TABLA SII.CGG_DHU_BECA.
* @return INT
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_COUNT(
)RETURNS INT AS
$$
DECLARE
TMP_ROWS INT2;
BEGIN
	SELECT COUNT(*) INTO TMP_ROWS
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE;
	RETURN TMP_ROWS;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_COUNT
* CONTABILIZA EL NUMERO DE REGISTROS DE LA TABLA SII.CGG_DHU_BECA.
* QUE CUMPLEN CON EL CRITERIO DE BUSQUEDA
* @param IN_FIND_TEXT CRITERIO DE BUSQUEDA
* @return TOTAL DE REGISTROS
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_COUNT(
IN IN_FIND_TEXT TEXT
)RETURNS INT AS
$$
DECLARE
TMP_ROWS INT2;
BEGIN
	SELECT COUNT(*) INTO TMP_ROWS
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND SII.F_STRING_IN(IN_FIND_TEXT,COALESCE(CDBEC_NUMERO, '''')||' '||COALESCE(CDBEC_FECHA_INGRESO, CURRENT_TIMESTAMP)||' '||COALESCE(CDBEC_FUNCIONARIO, '''')||' '||COALESCE(CDBEC_NUMERO_APROBACION, '''')||' '||COALESCE(CDBEC_FECHA_INICIO, CURRENT_TIMESTAMP)||' '||COALESCE(CDBEC_FECHA_FIN, CURRENT_TIMESTAMP)||' '||COALESCE(CDBEC_NUMERO_CONVENIO, '''')||' '||COALESCE(CDBEC_VSALIDA_ORIGEN, '''')||' '||COALESCE(CDBEC_VSALIDA_DESTINO, '''')||' '||COALESCE(CDBEC_VSALIDA_VALOR, 0)||' '||COALESCE(CDBEC_VRETORNO_ORIGEN, '''')||' '||COALESCE(CDBEC_VRETORNO_DESTINO, '''')||' '||COALESCE(CDBEC_VRETORNO_VALOR, 0)||' '||COALESCE(CDBEC_CARRERA, '''')||' '||COALESCE(CDBEC_TIPO_CICLO, 0)||' '||COALESCE(CDBEC_TOTAL_CICLOS, 0)||' '||COALESCE(CDBEC_NUMERO_CUENTO, '''')||' '||COALESCE(CDBEC_NUMERO_APROBACION_MODIFICATORIO,'''')||' '||COALESCE(CDBEC_NUMERO_CONTRATO_MODIFICATORIO,'''')||' '||COALESCE(CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,'''')||' '||COALESCE(CDBEC_OBSERVACION, '''')||' '||COALESCE(CDBEC_TITULO_ENTREGADO, FALSE)||' '||COALESCE(CDBEC_BECA_DEVENGADA, FALSE)||' '||COALESCE(CDBEC_ESTADO_APROBACION, 0)||' '||COALESCE(CDBEC_VALOR_REEMBOLSO, 0)||' '||COALESCE(CDBEC_ESTADO, FALSE)||' '||COALESCE(CDBEC_FECHA_INSERT, CURRENT_TIMESTAMP)||' '||COALESCE(CDBEC_USUARIO_INSERT, '''')||' '||COALESCE(CDBEC_FECHA_UPDATE, CURRENT_TIMESTAMP)||' '||COALESCE(CDBEC_USUARIO_UPDATE, '''')) = 1;
	RETURN TMP_ROWS;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_UPDATE
* ACTUALIZA UN REGISTRO EN LA TABLA sii.CGG_DHU_BECA.
* @param IN_CDBEC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE BECA
* @param IN_CDTBC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TIPO DE BECA
* @param IN_CGESP_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE ESPECIALIDAD
* @param IN_CGIED_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE INSTITUCION EDUCATIVA
* @param IN_CPAIS_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE PAIS
* @param IN_CGTPR_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TITULO PROFESONAL
* @param IN_CRPER_CODIGO CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA
* @param IN_CGG_CRPER_CODIGO CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA FUNCIONARIO CGG
* @param IN_CRPJR_CODIGO IDENTIFICATIVO UNICO DE REGSITRO  ENTIDAD FINANCIERA
* @param IN_CDBEC_NUMERO NUMERO DE LA BECA FORMADO POR LA ABREVIATURA DEL TIPO DE BECA MAS SECUENCIAL
* @param IN_CDBEC_FECHA_INGRESO FECHA DE INGRESO A LA BECA O CARRERA
* @param IN_CDBEC_FUNCIONARIO NOMBRE DEL FUNCIONARIO QUE APROBO LA BECA O CARRERA
* @param IN_CDBEC_NUMERO_APROBACION NUMERO DEL DOCUMENTO DE APROBACION DE LA BECA
* @param IN_CDBEC_FECHA_INICIO FECHA DE INICIO DE LA BECA 
* @param IN_CDBEC_FECHA_FIN FECHA DE FINALIZACION DE LA BECA 
* @param IN_CDBEC_NUMERO_CONVENIO NUMERO IDENTIFICADOR DEL CONTRATO O CONVENIO
* @param IN_CDBEC_VSALIDA_ORIGEN ORIGEN DEL VUELO DE SALIDA
* @param IN_CDBEC_VSALIDA_DESTINO DESTINO DEL VUELO DE SALIDA
* @param IN_CDBEC_VSALIDA_VALOR VALOR DEL PASAJE DE SALIDA
* @param IN_CDBEC_VRETORNO_ORIGEN ORIGEN DEL VUELO DE RETORNO
* @param IN_CDBEC_VRETORNO_DESTINO DESTINO DEL VUELO DE RETORNO
* @param IN_CDBEC_VRETORNO_VALOR VALOR DEL PASAJE DE RETORNO
* @param IN_CDBEC_CARRERA NOMBRE DE LA CARRERA A SEGUIR 
* @param IN_CDBEC_TIPO_CICLO TIPOS DE CICLIO DE LAS CARRERAS PROFESIONALES
0 - ANUAL
1 - SEMESTRAL
2 - QUIMESTRAL
3 - OTROS
* @param IN_CDBEC_TOTAL_CICLOS TOTAL DE CICLIO QUE DEBE CUMPLIR PARA APROBAR LA CARRERA.
* @param IN_CDBEC_NUMERO_CUENTO NUEMRO DE CUENTA PARA EL DEPOSITO DEL DINERO DE LA BECA
* @param IN_CDBEC_NUMERO_APROBACION_MODIFICATORIO NUMERO DEL DOCUMENTO DE APROBACION DE LA BECA MODIFICADA
* @param IN_CDBEC_NUMERO_CONTRATO_MODIFICATORIO NUMERO DEL DOCUMENTO DE CONTRATO MODIFICATORIO DE LA BECA
* @param IN_CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO OBSERVACION DEL DOCUMENTO DE CONTRATO MODIFICATORIO
* @param IN_CDBEC_OBSERVACION INFORMACION ADICIONAL
* @param IN_CDBEC_TITULO_ENTREGADO ESTADO QUE DETERMINA SI LA PERSONA ENTREGO UNA COPIA DE SU TITULO PROFESIONAL
* @param IN_CDBEC_BECA_DEVENGADA DETERMINA SI UNA BECA YA FUE RECOMPENSADA CON TRABAJO EN LA PROVINCIA
* @param IN_CDBEC_ESTADO_APROBACION CAMPO NUMERICO QUE INDICA LOS ESTADOS DE CONCLUSION DE LAS BECAS:
 0 - NO CONCLUIDA 
 1 - CONCLUIDA
 2 - REPROBADA
 3 - TERMINADA POR CASO FORTUITO

* @param IN_CDBEC_VALOR_REEMBOLSO CAMPO QUE SE REGISTRA EL VALOR DE REMBOLSO POR NO CULMINAR LA BECA
* @param IN_CDBEC_ESTADO ESTADO DEL REGISTRO
* @param IN_CDBEC_USUARIO_UPDATE USUARIO QUE REALIZO LA ACTUALIZACION DE LA INFORMACION
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_UPDATE(
IN IN_CDBEC_CODIGO SII.CGG_DHU_BECA.CDBEC_CODIGO%TYPE, 
IN IN_CDTBC_CODIGO SII.CGG_DHU_BECA.CDTBC_CODIGO%TYPE, 
IN IN_CGESP_CODIGO SII.CGG_DHU_BECA.CGESP_CODIGO%TYPE, 
IN IN_CGIED_CODIGO SII.CGG_DHU_BECA.CGIED_CODIGO%TYPE, 
IN IN_CPAIS_CODIGO SII.CGG_DHU_BECA.CPAIS_CODIGO%TYPE, 
IN IN_CGTPR_CODIGO SII.CGG_DHU_BECA.CGTPR_CODIGO%TYPE, 
IN IN_CRPER_CODIGO SII.CGG_DHU_BECA.CRPER_CODIGO%TYPE, 
IN IN_CGG_CRPER_CODIGO SII.CGG_DHU_BECA.CGG_CRPER_CODIGO%TYPE, 
IN IN_CRPJR_CODIGO SII.CGG_DHU_BECA.CRPJR_CODIGO%TYPE, 
IN IN_CDBEC_NUMERO SII.CGG_DHU_BECA.CDBEC_NUMERO%TYPE, 
IN IN_CDBEC_FECHA_INGRESO SII.CGG_DHU_BECA.CDBEC_FECHA_INGRESO%TYPE, 
IN IN_CDBEC_FUNCIONARIO SII.CGG_DHU_BECA.CDBEC_FUNCIONARIO%TYPE, 
IN IN_CDBEC_NUMERO_APROBACION SII.CGG_DHU_BECA.CDBEC_NUMERO_APROBACION%TYPE, 
IN IN_CDBEC_FECHA_INICIO SII.CGG_DHU_BECA.CDBEC_FECHA_INICIO%TYPE, 
IN IN_CDBEC_FECHA_FIN SII.CGG_DHU_BECA.CDBEC_FECHA_FIN%TYPE, 
IN IN_CDBEC_NUMERO_CONVENIO SII.CGG_DHU_BECA.CDBEC_NUMERO_CONVENIO%TYPE, 
IN IN_CDBEC_VSALIDA_ORIGEN SII.CGG_DHU_BECA.CDBEC_VSALIDA_ORIGEN%TYPE, 
IN IN_CDBEC_VSALIDA_DESTINO SII.CGG_DHU_BECA.CDBEC_VSALIDA_DESTINO%TYPE, 
IN IN_CDBEC_VSALIDA_VALOR SII.CGG_DHU_BECA.CDBEC_VSALIDA_VALOR%TYPE, 
IN IN_CDBEC_VRETORNO_ORIGEN SII.CGG_DHU_BECA.CDBEC_VRETORNO_ORIGEN%TYPE, 
IN IN_CDBEC_VRETORNO_DESTINO SII.CGG_DHU_BECA.CDBEC_VRETORNO_DESTINO%TYPE, 
IN IN_CDBEC_VRETORNO_VALOR SII.CGG_DHU_BECA.CDBEC_VRETORNO_VALOR%TYPE, 
IN IN_CDBEC_CARRERA SII.CGG_DHU_BECA.CDBEC_CARRERA%TYPE, 
IN IN_CDBEC_TIPO_CICLO SII.CGG_DHU_BECA.CDBEC_TIPO_CICLO%TYPE, 
IN IN_CDBEC_TOTAL_CICLOS SII.CGG_DHU_BECA.CDBEC_TOTAL_CICLOS%TYPE, 
IN IN_CDBEC_NUMERO_CUENTO SII.CGG_DHU_BECA.CDBEC_NUMERO_CUENTO%TYPE, 
IN IN_CDBEC_NUMERO_APROBACION_MODIFICATORIO SII.CGG_DHU_BECA.CDBEC_NUMERO_APROBACION_MODIFICATORIO%TYPE,
IN IN_CDBEC_NUMERO_CONTRATO_MODIFICATORIO SII.CGG_DHU_BECA.CDBEC_NUMERO_CONTRATO_MODIFICATORIO%TYPE,
IN IN_CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO SII.CGG_DHU_BECA.CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO%TYPE,
IN IN_CDBEC_OBSERVACION SII.CGG_DHU_BECA.CDBEC_OBSERVACION%TYPE, 
IN IN_CDBEC_TITULO_ENTREGADO SII.CGG_DHU_BECA.CDBEC_TITULO_ENTREGADO%TYPE, 
IN IN_CDBEC_BECA_DEVENGADA SII.CGG_DHU_BECA.CDBEC_BECA_DEVENGADA%TYPE, 
IN IN_CDBEC_ESTADO_APROBACION SII.CGG_DHU_BECA.CDBEC_ESTADO_APROBACION%TYPE, 
IN IN_CDBEC_VALOR_REEMBOLSO SII.CGG_DHU_BECA.CDBEC_VALOR_REEMBOLSO%TYPE, 
IN IN_CDBEC_ESTADO SII.CGG_DHU_BECA.CDBEC_ESTADO%TYPE, 
IN IN_CDBEC_USUARIO_UPDATE SII.CGG_DHU_BECA.CDBEC_USUARIO_UPDATE%TYPE
)RETURNS VOID AS
$$
BEGIN
	UPDATE SII.CGG_DHU_BECA SET
		CDTBC_CODIGO = IN_CDTBC_CODIGO, 
		CGESP_CODIGO = IN_CGESP_CODIGO, 
		CGIED_CODIGO = IN_CGIED_CODIGO, 
		CPAIS_CODIGO = IN_CPAIS_CODIGO, 
		CGTPR_CODIGO = IN_CGTPR_CODIGO, 
		CRPER_CODIGO = IN_CRPER_CODIGO, 
		CGG_CRPER_CODIGO = IN_CGG_CRPER_CODIGO, 
		CRPJR_CODIGO = IN_CRPJR_CODIGO, 
		CDBEC_NUMERO = IN_CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO = IN_CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO = IN_CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION = IN_CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO = IN_CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN = IN_CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO = IN_CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN = IN_CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO = IN_CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR = IN_CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN = IN_CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO = IN_CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR = IN_CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA = IN_CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO = IN_CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS = IN_CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO = IN_CDBEC_NUMERO_CUENTO, 
		CDBEC_NUMERO_APROBACION_MODIFICATORIO = IN_CDBEC_NUMERO_APROBACION_MODIFICATORIO, 
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO = IN_CDBEC_NUMERO_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO = IN_CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION = IN_CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO = IN_CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA = IN_CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION = IN_CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO = IN_CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO = IN_CDBEC_ESTADO, 
		CDBEC_FECHA_UPDATE = CURRENT_TIMESTAMP, 
		CDBEC_USUARIO_UPDATE = IN_CDBEC_USUARIO_UPDATE
	WHERE
		CDBEC_CODIGO = IN_CDBEC_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_SELECT
* SELECCIONA UN REGISTRO EN LA TABLA SII.CGG_DHU_BECA.
* @param IN_CDBEC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE BECA
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_SELECT(
IN IN_CDBEC_CODIGO SII.CGG_DHU_BECA.CDBEC_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO, 
		CDBEC_NUMERO_APROBACION_MODIFICATORIO, 
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND 
		CDBEC_CODIGO = IN_CDBEC_CODIGO;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_DELETE
* ELIMINA UN REGISTRO EN LA TABLA SII.CGG_DHU_BECA.
* @param IN_CDBEC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE BECA
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_DELETE(
IN IN_CDBEC_CODIGO SII.CGG_DHU_BECA.CDBEC_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	DELETE FROM SII.CGG_DHU_BECA
	WHERE
		CDBEC_CODIGO = IN_CDBEC_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_DELETE_SOFT
* ELIMINA LOGICAMENTE UN REGISTRO EN LA TABLA SII.CGG_DHU_BECA
* @param IN_CDBEC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE BECA
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_DELETE_SOFT(
IN IN_CDBEC_CODIGO SII.CGG_DHU_BECA.CDBEC_CODIGO%TYPE
)RETURNS VOID AS
$$
DECLARE
	TMP_ESTADO VARCHAR;
BEGIN
	
	SELECT CDBEC_ESTADO_APROBACION INTO TMP_ESTADO FROM CGG_DHU_BECA WHERE CDBEC_ESTADO=TRUE AND CDBEC_CODIGO= IN_CDBEC_CODIGO;
	IF (TMP_ESTADO = '1') THEN
		UPDATE SII.CGG_DHU_BECA SET
			CDBEC_ESTADO = FALSE
		WHERE
			CDBEC_CODIGO = IN_CDBEC_CODIGO;
	ELSE
		RAISE EXCEPTION 'Solo se puede eliminar becas que estan en estado registrado';
	END IF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_S_CGG_ESPECIALIDAD
* SELECCIONA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_ESPECIALIDAD.
* @param IN_CGESP_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE ESPECIALIDAD
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_S_CGG_ESPECIALIDAD(
IN IN_CGESP_CODIGO SII.CGG_DHU_BECA.CGESP_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO, 
		CDBEC_NUMERO_APROBACION_MODIFICATORIO, 
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND 
		CGESP_CODIGO = IN_CGESP_CODIGO;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_ESPECIALIDAD
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_ESPECIALIDAD.
* @param IN_CGESP_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE ESPECIALIDAD
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_D_CGG_ESPECIALIDAD(
IN IN_CGESP_CODIGO SII.CGG_DHU_BECA.CGESP_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	DELETE FROM SII.CGG_DHU_BECA
	WHERE
		CGESP_CODIGO = IN_CGESP_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_ESPECIALIDAD
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_ESPECIALIDAD.
* @param IN_CGESP_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE ESPECIALIDAD
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_DS_CGG_ESPECIALIDAD(
IN IN_CGESP_CODIGO SII.CGG_DHU_BECA.CGESP_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	UPDATE SII.CGG_DHU_BECA SET
		cdbec_estado = false
	WHERE
		CGESP_CODIGO = IN_CGESP_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_S_CGG_INSTITUCION_EDUCATIVA
* SELECCIONA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_INSTITUCION_EDUCATIVA.
* @param IN_CGIED_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE INSTITUCION EDUCATIVA
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_S_CGG_INSTITUCION_EDUCATIVA(
IN IN_CGIED_CODIGO SII.CGG_DHU_BECA.CGIED_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO, 
		CDBEC_NUMERO_APROBACION_MODIFICATORIO, 
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND 
		CGIED_CODIGO = IN_CGIED_CODIGO;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_INSTITUCION_EDUCATIVA
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_INSTITUCION_EDUCATIVA.
* @param IN_CGIED_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE INSTITUCION EDUCATIVA
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_D_CGG_INSTITUCION_EDUCATIVA(
IN IN_CGIED_CODIGO SII.CGG_DHU_BECA.CGIED_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	DELETE FROM SII.CGG_DHU_BECA
	WHERE
		CGIED_CODIGO = IN_CGIED_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_INSTITUCION_EDUCATIVA
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_INSTITUCION_EDUCATIVA.
* @param IN_CGIED_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE INSTITUCION EDUCATIVA
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_DS_CGG_INSTITUCION_EDUCATIVA(
IN IN_CGIED_CODIGO SII.CGG_DHU_BECA.CGIED_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	UPDATE SII.CGG_DHU_BECA SET
		cdbec_estado = false
	WHERE
		CGIED_CODIGO = IN_CGIED_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_S_CGG_PAIS
* SELECCIONA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_PAIS.
* @param IN_CPAIS_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE PAIS
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_S_CGG_PAIS(
IN IN_CPAIS_CODIGO SII.CGG_DHU_BECA.CPAIS_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO, 
		CDBEC_NUMERO_APROBACION_MODIFICATORIO, 
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND 
		CPAIS_CODIGO = IN_CPAIS_CODIGO;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_PAIS
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_PAIS.
* @param IN_CPAIS_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE PAIS
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_D_CGG_PAIS(
IN IN_CPAIS_CODIGO SII.CGG_DHU_BECA.CPAIS_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	DELETE FROM SII.CGG_DHU_BECA
	WHERE
		CPAIS_CODIGO = IN_CPAIS_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_PAIS
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_PAIS.
* @param IN_CPAIS_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE PAIS
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_DS_CGG_PAIS(
IN IN_CPAIS_CODIGO SII.CGG_DHU_BECA.CPAIS_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	UPDATE SII.CGG_DHU_BECA SET
		cdbec_estado = false
	WHERE
		CPAIS_CODIGO = IN_CPAIS_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_S_CGG_RES_ENTIDAD_FINANCIERA
* SELECCIONA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_RES_ENTIDAD_FINANCIERA.
* @param IN_CRPJR_CODIGO IDENTIFICATIVO UNICO DE REGSITRO  ENTIDAD FINANCIERA
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_S_CGG_RES_ENTIDAD_FINANCIERA(
IN IN_CRPJR_CODIGO SII.CGG_DHU_BECA.CRPJR_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO,
		CDBEC_NUMERO_APROBACION_MODIFICATORIO, 
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND 
		CRPJR_CODIGO = IN_CRPJR_CODIGO;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_RES_ENTIDAD_FINANCIERA
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_RES_ENTIDAD_FINANCIERA.
* @param IN_CRPJR_CODIGO IDENTIFICATIVO UNICO DE REGSITRO  ENTIDAD FINANCIERA
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_D_CGG_RES_ENTIDAD_FINANCIERA(
IN IN_CRPJR_CODIGO SII.CGG_DHU_BECA.CRPJR_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	DELETE FROM SII.CGG_DHU_BECA
	WHERE
		CRPJR_CODIGO = IN_CRPJR_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_RES_ENTIDAD_FINANCIERA
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_RES_ENTIDAD_FINANCIERA.
* @param IN_CRPJR_CODIGO IDENTIFICATIVO UNICO DE REGSITRO  ENTIDAD FINANCIERA
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_DS_CGG_RES_ENTIDAD_FINANCIERA(
IN IN_CRPJR_CODIGO SII.CGG_DHU_BECA.CRPJR_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	UPDATE SII.CGG_DHU_BECA SET
		cdbec_estado = false
	WHERE
		CRPJR_CODIGO = IN_CRPJR_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_S_CGG_TITULO_PROFESIONAL
* SELECCIONA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_TITULO_PROFESIONAL.
* @param IN_CGTPR_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TITULO PROFESONAL
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_S_CGG_TITULO_PROFESIONAL(
IN IN_CGTPR_CODIGO SII.CGG_DHU_BECA.CGTPR_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO,
		CDBEC_NUMERO_APROBACION_MODIFICATORIO, 
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND 
		CGTPR_CODIGO = IN_CGTPR_CODIGO;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_TITULO_PROFESIONAL
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_TITULO_PROFESIONAL.
* @param IN_CGTPR_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TITULO PROFESONAL
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_D_CGG_TITULO_PROFESIONAL(
IN IN_CGTPR_CODIGO SII.CGG_DHU_BECA.CGTPR_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	DELETE FROM SII.CGG_DHU_BECA
	WHERE
		CGTPR_CODIGO = IN_CGTPR_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_TITULO_PROFESIONAL
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_TITULO_PROFESIONAL.
* @param IN_CGTPR_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TITULO PROFESONAL
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_DS_CGG_TITULO_PROFESIONAL(
IN IN_CGTPR_CODIGO SII.CGG_DHU_BECA.CGTPR_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	UPDATE SII.CGG_DHU_BECA SET
		cdbec_estado = false
	WHERE
		CGTPR_CODIGO = IN_CGTPR_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_S_CGG_DHU_TIPO_BECA
* SELECCIONA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_DHU_TIPO_BECA.
* @param IN_CDTBC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TIPO DE BECA
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_S_CGG_DHU_TIPO_BECA(
IN IN_CDTBC_CODIGO SII.CGG_DHU_BECA.CDTBC_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO,
		CDBEC_NUMERO_APROBACION_MODIFICATORIO, 
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND 
		CDTBC_CODIGO = IN_CDTBC_CODIGO;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_DHU_TIPO_BECA
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_DHU_TIPO_BECA.
* @param IN_CDTBC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TIPO DE BECA
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_D_CGG_DHU_TIPO_BECA(
IN IN_CDTBC_CODIGO SII.CGG_DHU_BECA.CDTBC_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	DELETE FROM SII.CGG_DHU_BECA
	WHERE
		CDTBC_CODIGO = IN_CDTBC_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_DHU_TIPO_BECA
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_DHU_TIPO_BECA.
* @param IN_CDTBC_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE TIPO DE BECA
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_DS_CGG_DHU_TIPO_BECA(
IN IN_CDTBC_CODIGO SII.CGG_DHU_BECA.CDTBC_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	UPDATE SII.CGG_DHU_BECA SET
		cdbec_estado = false
	WHERE
		CDTBC_CODIGO = IN_CDTBC_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_S_CGG_RES_PERSONA
* SELECCIONA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_RES_PERSONA.
* @param IN_CRPER_CODIGO CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA
* @param IN_CGG_CRPER_CODIGO CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA FUNCIONARIO CGG
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_S_CGG_RES_PERSONA(
IN IN_CRPER_CODIGO SII.CGG_DHU_BECA.CRPER_CODIGO%TYPE, 
IN IN_CGG_CRPER_CODIGO SII.CGG_DHU_BECA.CGG_CRPER_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CDBEC_CODIGO, 
		CDTBC_CODIGO, 
		CGESP_CODIGO, 
		CGIED_CODIGO, 
		CPAIS_CODIGO, 
		CGTPR_CODIGO, 
		CRPER_CODIGO, 
		CGG_CRPER_CODIGO, 
		CRPJR_CODIGO, 
		CDBEC_NUMERO, 
		CDBEC_FECHA_INGRESO, 
		CDBEC_FUNCIONARIO, 
		CDBEC_NUMERO_APROBACION, 
		CDBEC_FECHA_INICIO, 
		CDBEC_FECHA_FIN, 
		CDBEC_NUMERO_CONVENIO, 
		CDBEC_VSALIDA_ORIGEN, 
		CDBEC_VSALIDA_DESTINO, 
		CDBEC_VSALIDA_VALOR, 
		CDBEC_VRETORNO_ORIGEN, 
		CDBEC_VRETORNO_DESTINO, 
		CDBEC_VRETORNO_VALOR, 
		CDBEC_CARRERA, 
		CDBEC_TIPO_CICLO, 
		CDBEC_TOTAL_CICLOS, 
		CDBEC_NUMERO_CUENTO,
		CDBEC_NUMERO_APROBACION_MODIFICATORIO, 
		CDBEC_NUMERO_CONTRATO_MODIFICATORIO, 
		CDBEC_OBSERVACION_CONTRATO_MODIFICATORIO,
		CDBEC_OBSERVACION, 
		CDBEC_TITULO_ENTREGADO, 
		CDBEC_BECA_DEVENGADA, 
		CDBEC_ESTADO_APROBACION, 
		CDBEC_VALOR_REEMBOLSO, 
		CDBEC_ESTADO, 
		CDBEC_FECHA_INSERT, 
		CDBEC_USUARIO_INSERT, 
		CDBEC_FECHA_UPDATE, 
		CDBEC_USUARIO_UPDATE
	FROM SII.CGG_DHU_BECA
	WHERE CDBEC_ESTADO = TRUE AND 
		CRPER_CODIGO = IN_CRPER_CODIGO AND 
		CGG_CRPER_CODIGO = IN_CGG_CRPER_CODIGO;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_RES_PERSONA
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_RES_PERSONA.
* @param IN_CRPER_CODIGO CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA
* @param IN_CGG_CRPER_CODIGO CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA FUNCIONARIO CGG
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_D_CGG_RES_PERSONA(
IN IN_CRPER_CODIGO SII.CGG_DHU_BECA.CRPER_CODIGO%TYPE, 
IN IN_CGG_CRPER_CODIGO SII.CGG_DHU_BECA.CGG_CRPER_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	DELETE FROM SII.CGG_DHU_BECA
	WHERE
		CRPER_CODIGO = IN_CRPER_CODIGO AND 
		CGG_CRPER_CODIGO = IN_CGG_CRPER_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

/**
* FUNCION SII.F_CGG_DHU_BECA_D_CGG_RES_PERSONA
* ELIMINA TODOS LOS REGISTRO DE LA TABLA SII.CGG_DHU_BECA QUE ESTAN
* RELACIONADOS CON LA TABLA SII.CGG_RES_PERSONA.
* @param IN_CRPER_CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA
* @param IN_CGG_CRPER_CODIGO IDENTIFICATIVO DE REGISTRO DE PERSONA FUNCIONARIO CGG
* @return VOID
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_DHU_BECA_DS_CGG_RES_PERSONA(
IN IN_CRPER_CODIGO SII.CGG_DHU_BECA.CRPER_CODIGO%TYPE, 
IN IN_CGG_CRPER_CODIGO SII.CGG_DHU_BECA.CGG_CRPER_CODIGO%TYPE
)RETURNS VOID AS
$$
BEGIN
	UPDATE SII.CGG_DHU_BECA SET
		cdbec_estado = false
	WHERE
		CRPER_CODIGO = IN_CRPER_CODIGO AND 
		CGG_CRPER_CODIGO = IN_CGG_CRPER_CODIGO;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

