/**
* FUNCION SII.F_CGG_RES_INFORME_PAREJA_S_CGG_RES_MATRIMONIO
* SELECCIONA TODA LA INFORMACION RELACIONADA A LA TABAL CGG_RES_INFORME_PAREJA y CGG_RES_MATRIMONIO.
* @param IN_CRMTR_CODIGO IDENTIFICATIVO UNICO DE MATRIMONIO
* @return REFCURSOR
*/

CREATE OR REPLACE FUNCTION SII.F_CGG_RES_INFORME_PAREJA_S_CGG_RES_MATRIMONIO(IN_CRMTR_CODIGO CHARACTER VARYING)
  RETURNS SETOF REFCURSOR AS
$BODY$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		IR.CRINF_CODIGO, 
		IR.CROFM_CODIGO, 
		IR.CRINF_FECHA_ENTREGA,
		IR.CRINF_EXTRACTO,
		IR.CRINF_NUMERO_DOCUMENTO,
		IR.CRINF_OBSERVACION,
		IR.CRINF_ESTADO, 
		IR.CRINF_FECHA_INSERT, 
		IR.CRINF_USUARIO_INSERT, 
		IR.CRINF_FECHA_UPDATE, 
		IR.CRINF_USUARIO_UPDATE
	FROM SII.CGG_RES_INFORME_PAREJA IR
	INNER JOIN SII.CGG_RES_OFICIAL_MATRIMONIO OM ON OM.CROFM_CODIGO = IR.CROFM_CODIGO  
	WHERE IR.CRINF_ESTADO = TRUE AND 
		OM.CRMTR_CODIGO = IN_CRMTR_CODIGO;
	RETURN NEXT TMP_REF;
END
$BODY$
  LANGUAGE 'PLPGSQL' VOLATILE
  COST 100
  ROWS 1000;
  