/**
* FUNCION SII.F_CGG_RES_REPRESENTANTE_PERSONA_S_CGG_RES_PERSONA_JURIDICA
* SELECCIONA TODOS LOS REGISTRO DE LA TABLA SII.CGG_RES_REPRESENTANTE_LEGAL QUE ESTAN.
* RELACIONADOS CON LA TABLA SII.CGG_RES_PERSONA_JURIDICA.
* @param IN_CRPJR_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE PERSONA JURIDICA
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_RES_REPRESENTANTE_PERSONA_S_CGG_RES_PERSONA_JURIDICA(
IN IN_CRPJR_CODIGO SII.CGG_RES_REPRESENTANTE_LEGAL.CRPJR_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT
		CRRPT.CRRPT_CODIGO, 
		CRRPT.CRPER_CODIGO, 
		(SELECT COALESCE(CRPER_NOMBRES,'')||' '||COALESCE(CRPER_APELLIDO_PATERNO,'')||' '||COALESCE(CRPER_APELLIDO_MATERNO,'') FROM CGG_RES_PERSONA WHERE CRPER_CODIGO = CRRPT.CRPER_CODIGO) AS CRPER_NOMBRES,
		CRRPT.CRPJR_CODIGO, 
		CRRPT.CRRPT_FECHA_REGISTRO, 
		CRRPT.CRRPT_ACTIVO, 
		CRRPT.CRRPT_ESTADO, 
		CRRPT.CRRPT_FECHA_INSERT, 
		CRRPT.CRRPT_USUARIO_INSERT, 
		CRRPT.CRRPT_FECHA_UPDATE, 
		CRRPT.CRRPT_USUARIO_UPDATE
	FROM SII.CGG_RES_REPRESENTANTE_LEGAL CRRPT
	WHERE CRRPT.CRRPT_ESTADO = TRUE
	AND CRRPT.CRRPT_ACTIVO = TRUE AND 
		CRRPT.CRPJR_CODIGO = IN_CRPJR_CODIGO;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;






