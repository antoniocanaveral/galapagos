/**
* FUNCION SII.F_CGG_CANTON_SELECT_UP_BY_NAME
* SELECCIONA UN REGISTRO EN LA TABLA SII.CGG_CANTON, JUNTO CON SUS DATOS RELACIONADOS HACIA LOS NIVELES SUPERIORES.
* @param IN_CCTN_NOMBRE NOMBRE O DESCRIPCION DE CANTON
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_CANTON_SELECT_UP_BY_NAME(
IN IN_CCTN_CODIGO SII.CGG_CANTON.CCTN_CODIGO%TYPE
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT 
		CCTN.CCTN_CODIGO,
		CCTN.CCTN_NOMBRE, 
		CGPRV.CGPRV_CODIGO,
		CGPRV.CGPRV_NOMBRE,
		CPAIS.CPAIS_CODIGO, 
		CPAIS.CPAIS_NOMBRE 
	FROM CGG_CANTON CCTN 
	INNER JOIN CGG_PROVINCIA CGPRV ON (CCTN.CGPRV_CODIGO = CGPRV.CGPRV_CODIGO)
	INNER JOIN CGG_PAIS CPAIS ON (CGPRV.CPAIS_CODIGO = CPAIS.CPAIS_CODIGO)
	WHERE UPPER(CCTN.CCTN_CODIGO) = UPPER(IN_CCTN_CODIGO);
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;