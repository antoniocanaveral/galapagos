
/**
* FUNCION SII.F_CGG_ISLA_SELECT_ATENCION_CLIENTE
* SELECCIONA TODOS LOS REGISTROS DE LA TABLA SII.CGG_ISLA DESDE DONDE SE PUEDA ATENTER UN TRAMITE.
* @param IN_USER_NAME NOMBRE DE USUARIO DEL SERVIDOR DE APP. O DE LA BASE DE DATOS
* @return REFCURSOR
*/
CREATE OR REPLACE FUNCTION SII.F_CGG_ISLA_SELECT_ATENCION_CLIENTE(
IN IN_USER_NAME VARCHAR
)RETURNS SETOF REFCURSOR AS
$$
DECLARE
	TMP_REF REFCURSOR;
BEGIN
	OPEN TMP_REF FOR
	SELECT DISTINCT
		 ISLA.CISLA_CODIGO,
		 ISLA.CCTN_CODIGO,
		 ISLA.CISLA_NOMBRE,
		 ISLA.CISLA_ABREVIATURA
	FROM CGG_RES_FASE FAS
	INNER JOIN CGG_RES_FASE_USUARIO FASU ON (FAS.CRFAS_CODIGO =FASU.CRFAS_CODIGO)
	INNER JOIN CGG_USUARIO CUSU ON (CUSU.CUSU_CODIGO = FASU.CUSU_CODIGO)
	INNER JOIN CGG_ISLA ISLA ON (ISLA.CISLA_CODIGO = CUSU.CISLA_CODIGO)
	WHERE FAS.CRFAS_ESTADO = TRUE 
	AND FASU.CRFSU_ESTADO = TRUE 
	AND CUSU.CUSU_ESTADO = TRUE
	AND ISLA.CISLA_ESTADO = TRUE;
	RETURN NEXT TMP_REF;
END
$$
LANGUAGE 'plpgsql' VOLATILE CALLED ON NULL INPUT;

