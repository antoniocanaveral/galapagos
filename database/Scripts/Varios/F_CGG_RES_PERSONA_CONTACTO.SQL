/**
* FUNCION SII.F_CGG_RES_PERSONA_CONTACTO_SELECT_CONTACTO
* SELECCIONA UN REGISTRO EN LA TABLA SII.CGG_RES_PERSONA_CONTACTO.
* @param IN_CRPER_CODIGO IDENTIFICATIVO UNICO DE REGISTRO DE PERSONA
* @return REFCURSOR
*/

CREATE OR REPLACE FUNCTION SII.F_CGG_RES_PERSONA_CONTACTO_SELECT_CONTACTO(IN IN_CRPER_CODIGO SII.CGG_RES_PERSONA_CONTACTO.CRPER_CODIGO%TYPE)
  RETURNS SETOF REFCURSOR AS
$BODY$
DECLARE
      TMP_REF REFCURSOR;
BEGIN
   OPEN TMP_REF FOR
   SELECT
	CON.CRPRC_CODIGO, 
	CON.CRPER_CODIGO,
	CON.CRTCO_CODIGO,
	CON.CRPRC_DESCRIPCION,
	CON.CRPRC_CONTACTO,
	TCN.CRTCO_NOMBRE,
	TCN.CRTCO_NOMBRE_IMAGEN 
	FROM SII.CGG_RES_PERSONA_CONTACTO CON
	INNER JOIN SII.CGG_RES_TIPO_CONTACTO TCN
	ON CON.CRTCO_CODIGO=TCN.CRTCO_CODIGO
	WHERE CON.CRPRC_ESTADO = TRUE AND
	      CON.CRPER_CODIGO=IN_CRPER_CODIGO; 
	RETURN NEXT TMP_REF;
END
$BODY$
  LANGUAGE 'PLPGSQL' VOLATILE
  COST 100
  ROWS 1000;



